{"ast":null,"code":"var _jsxFileName = \"D:\\\\\\u0421\\u0430\\u0439\\u0442 10.06.2021\\\\my-app\\\\src\\\\App.js\",\n    _s = $RefreshSig$();\n\nimport \"./App.css\";\nimport React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction App() {\n  _s();\n\n  //Обьекты с информацией о фотографиях\n  const [photos, setPhotos] = useState([]); //хранит в себе номер текущей страници\n\n  const [currentPage, setCurrentPage] = useState([1]); //принимает true когда подгружаем данные\n\n  const [fetching, setFetching] = useState(true);\n  const [totalCount, setTotalCount] = useState(0);\n  useEffect(() => {\n    if (fetching) {\n      console.log('fetching');\n      axios.get(` https://jsonplaceholder.typicode.com/photos?_limit=20&_page=${currentPage}`) //получаем результат запроса\n      .then(response => {\n        //из запроса приходят фотографии, обновляем соостояние и добавляем туда полученные фотографии\n        setPhotos([...photos, ...response.data]);\n        setCurrentPage(prevState => prevState + 1);\n        console.log(setCurrentPage);\n        setTotalCount(response.headers['x-total-count']);\n      }).finally(() => setFetching(false));\n    }\n  }, [fetching]); //Внутри колбэка повесим слушатель 'scroll' на документ\n\n  useEffect(() => {\n    document.addEventListener('scroll', scrollHandler);\n    return function () {\n      // удаляем слушатель\n      document.removeEventListener('scroll', scrollHandler);\n    };\n  }, [fetching]); //Ф-я которая будет вызываться при скроле страници\n\n  const scrollHandler = e => {\n    if ( // e.target.documentElement.scrollHandler - общая высота страници с учётом скрола\n    // e.target.documentElement.scrollTop - текущее положение скрола от верха страници\n    // window.innerHandler - высота видимой области страници\n    e.target.documentElement.scrollHandler - (e.target.documentElement.scrollTop + window.innerHandler) < 100 && photos.length === totalCount) {\n      setFetching(true);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"app\",\n    children: photos.map(photo => /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"photo\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"title\",\n        children: [photo.id, \" \", photo.title]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        src: photo.thumbnailUrl,\n        alt: \"\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 11\n      }, this)]\n    }, photo.id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 9\n    }, this))\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"5cRwoZhvRiyUjXrZX55JUwvuw7U=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["D:/Сайт 10.06.2021/my-app/src/App.js"],"names":["React","useState","useEffect","axios","App","photos","setPhotos","currentPage","setCurrentPage","fetching","setFetching","totalCount","setTotalCount","console","log","get","then","response","data","prevState","headers","finally","document","addEventListener","scrollHandler","removeEventListener","e","target","documentElement","scrollTop","window","innerHandler","length","map","photo","id","title","thumbnailUrl"],"mappings":";;;AAAA,OAAO,WAAP;AACA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,KAAP,MAAkB,OAAlB;;;AAEA,SAASC,GAAT,GAAe;AAAA;;AACb;AACA,QAAM,CAACC,MAAD,EAASC,SAAT,IAAsBL,QAAQ,CAAC,EAAD,CAApC,CAFa,CAGb;;AACA,QAAM,CAACM,WAAD,EAAcC,cAAd,IAAgCP,QAAQ,CAAC,CAAC,CAAD,CAAD,CAA9C,CAJa,CAKb;;AACA,QAAM,CAACQ,QAAD,EAAWC,WAAX,IAA0BT,QAAQ,CAAC,IAAD,CAAxC;AAEA,QAAM,CAACU,UAAD,EAAaC,aAAb,IAA8BX,QAAQ,CAAC,CAAD,CAA5C;AAEAC,EAAAA,SAAS,CAAC,MAAM;AACV,QAAIO,QAAJ,EAAc;AACZI,MAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ;AACJX,MAAAA,KAAK,CACFY,GADH,CAEI,gEAA+DR,WAAY,EAF/E,EAGE;AAHF,OAIGS,IAJH,CAIQC,QAAQ,IAAI;AAChB;AACAX,QAAAA,SAAS,CAAE,CAAC,GAAGD,MAAJ,EAAY,GAAGY,QAAQ,CAACC,IAAxB,CAAF,CAAT;AACAV,QAAAA,cAAc,CAACW,SAAS,IAAIA,SAAS,GAAC,CAAxB,CAAd;AACAN,QAAAA,OAAO,CAACC,GAAR,CAAYN,cAAZ;AACDI,QAAAA,aAAa,CAACK,QAAQ,CAACG,OAAT,CAAiB,eAAjB,CAAD,CAAb;AACA,OAVH,EAWGC,OAXH,CAWW,MAAMX,WAAW,CAAC,KAAD,CAX5B;AAYD;AACF,GAhBQ,EAgBN,CAACD,QAAD,CAhBM,CAAT,CAVa,CA4Bb;;AACAP,EAAAA,SAAS,CAAC,MAAM;AACdoB,IAAAA,QAAQ,CAACC,gBAAT,CAA0B,QAA1B,EAAoCC,aAApC;AAEA,WAAO,YAAY;AACjB;AACAF,MAAAA,QAAQ,CAACG,mBAAT,CAA6B,QAA7B,EAAuCD,aAAvC;AACD,KAHD;AAID,GAPQ,EAON,CAACf,QAAD,CAPM,CAAT,CA7Ba,CAqCb;;AACA,QAAMe,aAAa,GAAIE,CAAD,IAAO;AAC3B,SACE;AACA;AACA;AACAA,IAAAA,CAAC,CAACC,MAAF,CAASC,eAAT,CAAyBJ,aAAzB,IACGE,CAAC,CAACC,MAAF,CAASC,eAAT,CAAyBC,SAAzB,GAAqCC,MAAM,CAACC,YAD/C,IAEE,GAFF,IAGA1B,MAAM,CAAC2B,MAAP,KAAkBrB,UAPpB,EAOiC;AAC/BD,MAAAA,WAAW,CAAC,IAAD,CAAX;AACD;AACF,GAXD;;AAYA,sBACE;AAAK,IAAA,SAAS,EAAE,KAAhB;AAAA,cACKL,MAAM,CAAC4B,GAAP,CAAYC,KAAD,iBACZ;AAAK,MAAA,SAAS,EAAC,OAAf;AAAA,8BACE;AAAK,QAAA,SAAS,EAAC,OAAf;AAAA,mBACGA,KAAK,CAACC,EADT,OACcD,KAAK,CAACE,KADpB;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,eAIE;AAAK,QAAA,GAAG,EAAEF,KAAK,CAACG,YAAhB;AAA8B,QAAA,GAAG,EAAC;AAAlC;AAAA;AAAA;AAAA;AAAA,cAJF;AAAA,OAA4BH,KAAK,CAACC,EAAlC;AAAA;AAAA;AAAA;AAAA,YADC;AADL;AAAA;AAAA;AAAA;AAAA,UADF;AAYD;;GA9DQ/B,G;;KAAAA,G;AAgET,eAAeA,GAAf","sourcesContent":["import \"./App.css\";\nimport React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\n\nfunction App() {\n  //Обьекты с информацией о фотографиях\n  const [photos, setPhotos] = useState([]);\n  //хранит в себе номер текущей страници\n  const [currentPage, setCurrentPage] = useState([1]);\n  //принимает true когда подгружаем данные\n  const [fetching, setFetching] = useState(true);\n\n  const [totalCount, setTotalCount] = useState(0);\n\n  useEffect(() => {\n        if (fetching) {\n          console.log('fetching');\n      axios\n        .get(\n         ` https://jsonplaceholder.typicode.com/photos?_limit=20&_page=${currentPage}`)\n        //получаем результат запроса\n        .then(response => {\n          //из запроса приходят фотографии, обновляем соостояние и добавляем туда полученные фотографии\n          setPhotos( [...photos, ...response.data]);\n          setCurrentPage(prevState => prevState+1);\n          console.log(setCurrentPage);\n         setTotalCount(response.headers['x-total-count']);\n        })\n        .finally(() => setFetching(false));\n    }\n  }, [fetching]);\n\n  //Внутри колбэка повесим слушатель 'scroll' на документ\n  useEffect(() => {\n    document.addEventListener('scroll', scrollHandler);\n\n    return function () {\n      // удаляем слушатель\n      document.removeEventListener('scroll', scrollHandler);\n    };\n  }, [fetching]);\n  //Ф-я которая будет вызываться при скроле страници\n  const scrollHandler = (e) => {\n    if (\n      // e.target.documentElement.scrollHandler - общая высота страници с учётом скрола\n      // e.target.documentElement.scrollTop - текущее положение скрола от верха страници\n      // window.innerHandler - высота видимой области страници\n      e.target.documentElement.scrollHandler -\n        (e.target.documentElement.scrollTop + window.innerHandler) <\n        100  &&\n      photos.length === totalCount ) {\n      setFetching(true);\n    }\n  };\n  return (\n    <div className={\"app\"}>\n        {photos.map((photo) => (\n        <div className=\"photo\" key={photo.id}>\n          <div className=\"title\">\n            {photo.id} {photo.title}\n          </div>\n          <img src={photo.thumbnailUrl} alt=\"\" />\n        </div>\n      ))}\n    </div>\n  );\n}\n\nexport default App;\n\n"]},"metadata":{},"sourceType":"module"}